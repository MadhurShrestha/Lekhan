<div id="wrapper">
  <!-- Sidebar -->
  <%= render "shared/sidebar" %>

  <!-- End of Sidebar -->
  <!-- Content Wrapper -->
  <div id="content-wrapper" class="d-flex flex-column">
    <!-- Main Content -->
    <div id="content">
      <div class="container mt-3">
    <%= render 'shared/breadcrumbs' %>

       <div class="container mt-3">
  <%= render 'title_form', notebook: @notebook, page: @page %>

  <%= DateTime.current.strftime("%A, %e %B ") %>

  <%= render 'page_form', notebook: @notebook, page: @page%>
</div>

      </div>
    </div>


  </div>
</div>

<script type="text/javascript">
  function savePage() {
    $('#auto-save-status').html('Saving...').removeClass('text-danger').removeClass('text-success');
    var form = $('form.content-form').serialize();
    $.ajax({
      type: 'PUT',
      url: '/notebooks/<%= @notebook.id %>/pages/<%= @page.id %>.json',
      data: form,
      dataType: 'JSON',
      success: function() {
        $('#auto-save-status').html('Saved.').removeClass('text-danger').addClass('text-success')
      },
      error: function() {
        $('#auto-save-status').html('Autosave Failed. Please try saving.').removeClass('text-success').addClass('text-danger');
      }
    });
  }

  document.addEventListener('turbolinks:load', () => {
    setInterval(savePage, 10000);
  });
</script>
