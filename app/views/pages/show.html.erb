<div id="wrapper">
  <!-- Sidebar -->
  <%= render "shared/sidebar" %>

  <!-- End of Sidebar -->
  <!-- Content Wrapper -->
  <div id="content-wrapper" class="d-flex flex-column">
    <!-- Main Content -->
    <div id="content">
      <div class="container mt-3">
    <%= render 'shared/breadcrumbs' %>

        <%= render 'title_form' %>
        <div class=" mt-2">
      <%= form_with(model: [@notebook, @page, @checklist], html: { class: 'float-right'}, local: false) do  |form|%>
      <%= form.submit "Add Checklist", class: 'btn btn-primary ml-5' %>
      <% end %>
      <!-- Button trigger modal -->
<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
  Launch demo modal
</button>

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        ...
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>
    </div>
    <%= render @page.checklists %>
        <%= DateTime.current.strftime("%A, %e %B ") %>
        <%= render 'page_form' %>

      </div>
    </div>


  </div>
</div>

<script type="text/javascript">
  function savePage() {
    $('#auto-save-status').html('Saving...').removeClass('text-danger').removeClass('text-success');
    var form = $('form.content-form').serialize();
    $.ajax({
      type: 'PUT',
      url: '/notebooks/<%= @notebook.id %>/pages/<%= @page.id %>.json',
      data: form,
      dataType: 'JSON',
      success: function() {
        $('#auto-save-status').html('Saved.').removeClass('text-danger').addClass('text-success')
      },
      error: function() {
        $('#auto-save-status').html('Autosave Failed. Please try saving.').removeClass('text-success').addClass('text-danger');
      }
    });
  }

  document.addEventListener('turbolinks:load', () => {
    setInterval(savePage, 10000);
  });
</script>
