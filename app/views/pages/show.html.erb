<div id="wrapper">
    <!-- Sidebar -->
    <%= render "shared/sidebar" %>
        <div class="sidebar-card d-none d-lg-flex">
            <p class="text-center mb-2"><strong>Journal It</strong>: Express your thoughts and feelings freely.</p>
        </div>
        </ul>
        <!-- End of Sidebar -->
        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">
            <!-- Main Content -->
            <div id="content">
                <div class="container mt-3">
                <%= render 'shared/breadcrumbs' %>
                <h4 class='d-flex justify-content-between  mb-4'>
                  <div>
                    <h6 class="cursive m-0"><%= @notebook.created_at.strftime("%A, %e %B ")%></h6>
                  </div>
                              <div class="float-right">
                    <%= form_with(model: [@notebook, @page, @checklist], html: { class: 'float-left'}, local: false) do  |form|%>
      <%= form.submit "Add Checklist", class: 'btn btn-primary ml-5' %>
    <% end %>
      </div>
                </h4>
                    <% if @page.content.persisted? %>
                        <div class="text-content  mt-5">
                            <% if @page.title.present? %>
                                <h1 class="cursive m-0"><%= @page.title %></h2>
                                <% else %>
                                    <h2 class="cursive">TITLE.... </h2>
                                    <% end %>
                        </div>
                        <%= render 'title_form' %>
                            <div class="text-content p-2 mt-3">
                                <% if @page.content.present? %>
                                    <%= @page.content %>
                                        <% else %>
                                            <h2 class="cursive">This page is so empty .... ü§∑üèº‚Äç‚ôÇÔ∏è</h2>
                                            <% end %>
                            </div>
                            <%= render 'page_form' %>
                                <% end %>
                </div>
            </div>
            <%= render @page.checklists %>
        </div>
</div>

<script type="text/javascript">
  function savePage() {
    $('#auto-save-status').html('Saving...').removeClass('text-danger').removeClass('text-success');
    var form = $('form.content-form').serialize();
    $.ajax({
      type: 'PUT',
      url: '/notebooks/<%= @notebook.id %>/pages/<%= @page.id %>.json',
      data: form,
      dataType: 'JSON',
      success: function() {
        $('#auto-save-status').html('Saved.').removeClass('text-danger').addClass('text-success')
      },
      error: function() {
        $('#auto-save-status').html('Autosave Failed. Please try saving.').removeClass('text-success').addClass('text-danger');
      }
    });
  }

  document.addEventListener('turbolinks:load', () => {
    setInterval(savePage, 10000);
  });
</script>
